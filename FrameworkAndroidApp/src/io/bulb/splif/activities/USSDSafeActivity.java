package io.bulb.splif.activities;

import io.bulb.splif.R;
import io.bulb.splif.spf.core.Framework;

import android.app.Activity;

import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;

import android.widget.Button;
import android.widget.EditText;


public class USSDSafeActivity extends Activity implements
		AdapterView.OnItemSelectedListener, OnClickListener {
	Framework spf;

	private Button btnSubmit;
	private EditText edittext1, edittext2, edittext3;
	private String path;
	private String ip;
	private String key;

	@Override
	public void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.ussdsafe);
		btnSubmit = (Button) findViewById(R.id.btnSubmit);
		btnSubmit.setEnabled(false);
		btnSubmit.setClickable(false);
		btnSubmit.setOnClickListener(this);

		edittext1 = (EditText) findViewById(R.id.edittext);
		edittext1.setVisibility(View.INVISIBLE);
		edittext2 = (EditText) findViewById(R.id.edittext2);
		edittext2.setVisibility(View.INVISIBLE);
		edittext3 = (EditText) findViewById(R.id.edittext3);
		edittext3.setVisibility(View.INVISIBLE);


		path = spf.getPath();
		ip = spf.getControlIP();
		key = spf.getKey();

	}

	@Override
	public void onClick(View arg0) {
		String filename, number;

		String messagestring;
		String sendstr;

		EditText edit1 = (EditText) findViewById(R.id.edittext);
		EditText edit2 = (EditText) findViewById(R.id.edittext2);
		EditText edit3 = (EditText) findViewById(R.id.edittext3);

		path = edit1.getText().toString();
		filename = edit2.getText().toString();
		number = edit3.getText().toString();
		String mess1 = "This is a cool page: http://";
		String mess2 = mess1.concat(ip);
		String mess3 = mess2.concat(path);
		messagestring = mess3.concat(filename);
		String sendstr1 = key.concat(" ");
		String sendstr2 = sendstr1.concat("safe ");
		String sendstr3 = sendstr2.concat(path);
		String sendstr4 = sendstr3.concat(" ");
		String sendstr5 = sendstr4.concat(filename);
		String sendstr6 = sendstr5.concat(" ");
		sendstr = sendstr6.concat(number);

		spf.webUploadService(sendstr);
		spf.modem.sendSMS(number, messagestring);

	}

	@Override
	public void onItemSelected(AdapterView<?> parent, View view, int pos,
			long id) {

		EditText edit1 = (EditText) findViewById(R.id.edittext);
		EditText edit2 = (EditText) findViewById(R.id.edittext2);
		EditText edit3 = (EditText) findViewById(R.id.edittext3);
		Button button1 = (Button) findViewById(R.id.btnSubmit);

		edit1.setVisibility(View.VISIBLE);
		edit2.setVisibility(View.VISIBLE);
		edit3.setVisibility(View.VISIBLE);

		button1.setEnabled(true);
		button1.setClickable(true);

	}

	@Override
	public void onNothingSelected(AdapterView<?> arg0) {
		// TODO Auto-generated method stub

	}

}